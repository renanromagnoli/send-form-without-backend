<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário</title>
    <link rel="stylesheet" href="./global.css">
</head>
<body>
    <form action="https://formsubmit.co/a8e8df1251188613930fd083b100e3f2" method="POST">

        <input type="hidden" name="_next" value="http://127.0.0.1:5500/thanks.html">
        <input type="hidden" name="_autoresponse" value="Recebemos o seus dados no formulário!">

        <input type="text" name="name" id="nome" placeholder="Nome" required>
        <input type="email" id="email" name="email" placeholder="E-mail" onblur="checkMail()" onfocus="clickOnEmailField()" required>
        <span id="no-email"></span>
        <input type="text" id='assunto' name="subject" placeholder="Assunto" required>
        <textarea name="message" id="mensagem" cols="30" rows="10" placeholder="Mensagem" required></textarea>
        <button type="submit" id="botao" disabled>Enviar</button>
    </form>
</body>

<script>
    const name = document.querySelector('#nome')
    const email = document.querySelector('#email')
    const subject = document.querySelector('#assunto')
    const message = document.querySelector('#mensagem')
    const button = document.querySelector('#botao')
    const noEmail = document.querySelector('#no-email')

    // name.addEventListener('input', checkFills)
    // subject.addEventListener('input', checkFills)
    // message.addEventListener('input', checkFills)
    
    name.addEventListener('input', () => {
        if(name.value.length > 0){
            
            name.style.color = 'lightgreen'
            name.style.border = '4px solid lightgreen'
            name.style.boxShadow = '0 0 20px lightgreen'

            // name.classList.add('fieldOk')
        } else {
            // name.style.color = 'orange'
            name.style.border = '4px solid orange'
            name.style.boxShadow = '0 0 20px orange'
        }
        checkFills()
    })
    name.addEventListener('focus', () => {
        if(name.value.length === 0){
            name.style.borderColor = 'orange'
            name.style.boxShadow = '0 0 20px orange'
            name.placeholder = 'Informe o seu nome...'
        }
    })
    name.addEventListener('focusout', () => {
        if(name.value.length === 0){
            name.placeholder = 'Nome'
            
            name.style.borderColor = '#00AFEF'
            name.style.boxShadow = 'none'

        } else {
            name.style.color = 'lightgreen'
            name.style.border = '4px solid lightgreen'
            name.style.boxShadow = '0 0 20px lightgreen'
        }
    })
    
    email.addEventListener('input', checkMail)
    email.addEventListener('focus', () => {
        email.style.width = '230px'
        email.style.color = 'orange'
        email.style.border = '4px solid orange'
        email.style.boxShadow = '0 0 20px orange'
    })
    email.addEventListener('focusout', () => {
        if(email.value.length > 0 && !email.checkValidity()) {
            noEmail.style.display = 'block'
            noEmail.innerHTML = 'Email inválido!'
        }
        if(email.value.length === 0) {
            
            email.style.width = '200px'
            email.style.borderColor = '#00AFEF'
            email.style.boxShadow = 'none'
            // email.style.backgroundColor = 'none'
        }
    })

    subject.addEventListener('input', () => {
        if(subject.value.length > 0){
            // subject.style.borderColor = 'green'
            subject.style.color = 'lightgreen'
            subject.style.border = '4px solid lightgreen'
            subject.style.boxShadow = '0 0 20px lightgreen'
        } else {
            subject.style.border = '4px solid orange'
            subject.style.boxShadow = '0 0 20px orange'
        }
        checkFills()
    })
    subject.addEventListener('focus', () => {
        if(subject.value.length === 0){
            subject.style.borderColor = 'orange'
            subject.style.boxShadow = '0 0 20px orange'
            subject.placeholder = 'Informe o seu nome...'
        }
    })
    subject.addEventListener('focusout', () => {
        if(subject.value.length === 0){
            subject.placeholder = 'Nome'
            
            subject.style.borderColor = '#00AFEF'
            subject.style.boxShadow = 'none'

        } else {
            subject.style.color = 'lightgreen'
            subject.style.border = '4px solid lightgreen'
            subject.style.boxShadow = '0 0 20px lightgreen'
        }
    })



    message.addEventListener('input', () => {
        if(message.value.length > 0){
            // message.style.borderColor = 'green'
            message.style.color = 'lightgreen'
            message.style.border = '4px solid lightgreen'
            message.style.boxShadow = '0 0 20px lightgreen'
        }
        if(message.value.length === 0) {
            // message.style.color = 'orange'
            message.style.border = '4px solid orange'
            message.style.boxShadow = '0 0 20px orange'
        }
        checkFills()
    })
    message.addEventListener('focus', () => {
        if(message.value.length === 0){
            message.style.borderColor = 'orange'
            message.style.boxShadow = '0 0 20px orange'
            message.placeholder = 'Informe o seu nome...'
        }
    })
    message.addEventListener('focusout', () => {
        if(message.value.length === 0){
            message.placeholder = 'Nome'
            
            message.style.borderColor = '#00AFEF'
            message.style.boxShadow = 'none'

        } else {
            message.style.color = 'lightgreen'
            message.style.border = '4px solid lightgreen'
            message.style.boxShadow = '0 0 20px lightgreen'
        }
    })
    
    


    if(button.disabled) {
        button.title = 'Preencha os campos acima'
    } else {
        button.title = 'Enviar'
    }

    
    
    function checkMail() {
        
        email.placeholder = 'E-mail'
        noEmail.style.display = 'none'
        // console.log('validity: ', email.checkValidity())

        if(email.value.length === 0) {
            email.style.borderColor = 'orange'
            email.style.boxShadow = '0 0 20px orange'
        }
        
        
        if(email.value.length > 0 && !email.checkValidity()) {
            email.style.width = '230px'
            email.style.borderColor = 'red'
            email.style.boxShadow = '0 0 20px red'
            email.style.color = 'red'
            // setTimeout(() => {
            //     noEmail.style.display = 'block'
            //     noEmail.innerHTML = 'Email inválido!'
            // }, 3000)
        }
        if(email.checkValidity() && email.value.length > 0) {
            email.style.border = '4px solid lightgreen'
            email.style.boxShadow = '0 0 20px lightgreen'
            email.style.color = 'lightgreen'
        } 
        checkFills()
    }
    
    function checkFills() {
        button.disabled = !(name.value && email.value && email.checkValidity() && subject.value && message.value) 
    }

    function clickOnEmailField() {
        email.style.color = 'white'
        email.placeholder = 'Informe um e-mail válido...'
        noEmail.style.display = 'none'
    }

    
</script>
</html>